
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/img/logo.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.48">
    
    
      
        <title>Cypress - kbj's cheatsheets</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata:300,300i,400,400i,700,700i%7CInconsolata:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inconsolata";--md-code-font:"Inconsolata"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/cheatsheets.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="yellow">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cypress" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="kbj&#39;s cheatsheets" class="md-header__button md-logo" aria-label="kbj's cheatsheets" data-md-component="logo">
      
  <img src="../assets/img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            kbj's cheatsheets
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cypress
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        
  
    
  
  üè° Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="index.html" class="md-tabs__link">
        
  
    
  
  üßë‚Äçüéì Learning

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../watch/index.html" class="md-tabs__link">
        
  
    
  
  ‚öîÔ∏è Watch

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../tips/index.html" class="md-tabs__link">
        
  
    
  
  ü§ì Tips

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="kbj&#39;s cheatsheets" class="md-nav__button md-logo" aria-label="kbj's cheatsheets" data-md-component="logo">
      
  <img src="../assets/img/logo.png" alt="logo">

    </a>
    kbj's cheatsheets
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üè° Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üßë‚Äçüéì Learning
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../watch/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ‚öîÔ∏è Watch
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tips/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ü§ì Tips
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fundamental-basics" class="md-nav__link">
    <span class="md-ellipsis">
      Fundamental &amp; basics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fundamental & basics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-cypress" class="md-nav__link">
    <span class="md-ellipsis">
      Use cypress
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implicit-explicit-assertions" class="md-nav__link">
    <span class="md-ellipsis">
      Implicit &amp; explicit assertions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-vs-find" class="md-nav__link">
    <span class="md-ellipsis">
      get() vs find()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-4-seconds-rule" class="md-nav__link">
    <span class="md-ellipsis">
      The 4 seconds rule
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#then-should" class="md-nav__link">
    <span class="md-ellipsis">
      then &amp; should
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chaining-changing-subject" class="md-nav__link">
    <span class="md-ellipsis">
      Chaining &amp; changing subject
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tests-hooks" class="md-nav__link">
    <span class="md-ellipsis">
      Tests hooks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#commands-and-conquer-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Commands (and conquer) &amp; queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tasks" class="md-nav__link">
    <span class="md-ellipsis">
      Tasks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stubs" class="md-nav__link">
    <span class="md-ellipsis">
      Stubs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spies" class="md-nav__link">
    <span class="md-ellipsis">
      Spies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manipulating-the-clock" class="md-nav__link">
    <span class="md-ellipsis">
      Manipulating the clock
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interceptors" class="md-nav__link">
    <span class="md-ellipsis">
      Interceptors
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#good-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Good practices
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  
<nav class="md-tags" >
  
    
    
    
      <span class="md-tag">cypress</span>
    
  
    
    
    
      <span class="md-tag">tests</span>
    
  
</nav>



<p><a href="../index.html">üè° Home</a> &gt; <a href="index.html">Learning</a> &gt; üå≥ Cypress</p>
<h1 id="cypress">üå≥ Cypress</h1>
<h2 id="fundamental-basics">Fundamental &amp; basics</h2>
<h3 id="use-cypress">Use cypress</h3>
<ul>
<li><code>npx cypress open</code>: to run it from a browser.</li>
<li><code>npx cypress run</code>: to run it from CLI.</li>
</ul>
<h3 id="implicit-explicit-assertions">Implicit &amp; explicit assertions</h3>
<p>Some commands in Cypress (such as <code>visit()</code> or <code>contains()</code>) have implicit expectations, which means that we expect them to succeed before going to the next command.
If the <code>visit()</code> command fails because there's a typo in the url, the test will fail and won't go any further.</p>
<p>Explicit expectations are the one we explicitely check (such as <code>should('exist')</code> for example).</p>
<h3 id="get-vs-find"><code>get()</code> vs <code>find()</code></h3>
<p>Let's say we have this code (and forget about all the good practices it doesn't implement, it's for the example's sake): </p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">&lt;</span><span class="nt">section</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;products&quot;</span><span class="p">&gt;</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;./product-banner.png&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;Our products&quot;</span> <span class="p">/&gt;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    ...
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">&lt;/</span><span class="nt">section</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>We want to make sure that the img banner inside our section is indeed visible:</p>
<div class="language-js highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1">// This code is the most simple, it will work</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;section#products &gt; img&#39;</span><span class="p">).</span><span class="nx">should</span><span class="p">(</span><span class="s1">&#39;be.visible&#39;</span><span class="p">);</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1">// This code will work too : find will &quot;look inside&quot; the elements we got with the get() method</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;section#products&#39;</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">).</span><span class="nx">should</span><span class="p">(</span><span class="s1">&#39;be.visible&#39;</span><span class="p">);</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="c1">// This code will not seem like it, but it won&#39;t work the way we intend to: the second get() will not look &quot;inside&quot; the element we got in the first get(), but inside the DOM in general</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c1">// This code will actually look in the DOM for the section, then look in the DOM for the img. Both calls are not related.</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;section#products&#39;</span><span class="p">).</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">).</span><span class="nx">should</span><span class="p">(</span><span class="s1">&#39;be.visible&#39;</span><span class="p">);</span>
</span></code></pre></div>
<h3 id="the-4-seconds-rule">The 4 seconds rule</h3>
<p>There is a secret rule that is applied every time you make an assertion in Cypress : the 4 seconds rule. Basically, it means that if Cypress did not manage to do what you asked in the fiest place, it will retry for 4 seconds. If it manages to do it during this time, the assertion will pass. If not, an error mentionning a timeout will be displayed.</p>
<p>It applies to any assertion, even the simplest ones like <code>cy.get('section#products')</code>.</p>
<h3 id="then-should"><code>then</code> &amp; <code>should</code></h3>
<p>There are 2 alternative ways of writing this code: 
<div class="language-js highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1">// Classical syntax</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;section#products&#39;</span><span class="p">).</span><span class="nx">should</span><span class="p">(</span><span class="s1">&#39;have.attr&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;class&#39;</span><span class="p">).</span><span class="nx">and</span><span class="p">(</span><span class="s1">&#39;match&#39;</span><span class="p">,</span><span class="w"> </span><span class="sr">/invalid/</span><span class="p">);</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1">// Alternative #1</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;section#products&#39;</span><span class="p">).</span><span class="nx">should</span><span class="p">((</span><span class="nx">$section</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">  </span><span class="nx">expect</span><span class="p">(</span><span class="nx">$section</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">contain</span><span class="p">(</span><span class="s1">&#39;invalid&#39;</span><span class="p">);</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="p">});</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="c1">// Alternative #2</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;section#products&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">$section</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">  </span><span class="nx">expect</span><span class="p">(</span><span class="nx">$section</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">contain</span><span class="p">(</span><span class="s1">&#39;invalid&#39;</span><span class="p">);</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="p">});</span>
</span></code></pre></div></p>
<p>In both alternatives, the <code>$section</code> argument is no longer a Cypress object, but a HTML element. This means you must interact with it in a more classical test writing syntax, you can't use Cypress methods anymore.
This can be useful if you need to override the 4 seconds rule.</p>
<p>Both syntaxes are equivalent, but prefer <code>should</code> to <code>then</code> since it seems to behave more consistently.</p>
<h3 id="chaining-changing-subject">Chaining &amp; changing subject</h3>
<p>Take the following code:</p>
<div class="language-js highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;section#products&#39;</span><span class="p">).</span><span class="nx">should</span><span class="p">(</span><span class="s1">&#39;have.attr&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;class&#39;</span><span class="p">).</span><span class="nx">and</span><span class="p">(</span><span class="s1">&#39;match&#39;</span><span class="p">,</span><span class="w"> </span><span class="sr">/invalid/</span><span class="p">);</span>
</span></code></pre></div>
<p>Sometimes (but not always), when chaining multiple methods, the subject on which the next method applies is different than the one we started with.
It depends on the method and is usually quite logic.</p>
<p>In our example, we first work with the section that was retrieved. Then we check its class. The <code>and</code> method is then applied to the class, not to the section we were using before.</p>
<h3 id="tests-hooks">Tests hooks</h3>
<p>There are 4 tests hooks to remember : </p>
<ul>
<li><code>before</code>: any code in there will be executed once, before running the first test.</li>
<li><code>beforeAll</code>: any code in there will be executed before every test.</li>
<li><code>afterAll</code>: any code in there will be executed after every test.</li>
<li><code>after</code>: any code in there will be executed once, after running the last test.</li>
</ul>
<h3 id="commands-and-conquer-queries">Commands (and conquer) &amp; queries</h3>
<p>Commands &amp; queries are tools to import into Cypress core some actions you need to perform throughout your whole project (or a majority of files).</p>
<p>Commands are re-usable shortcuts for complex command chains.
Queries are synchronous, chainable retriable commands.</p>
<p>Some relevant examples might be:
- A command to login to the app before running tests.
- A command to mock fetching current user data.
- A command to mock any API call, which could reflect your API structure.
- A query to get an element by its data-cy attribute, that would return the element</p>
<h3 id="tasks">Tasks</h3>
<p>Tasks are functions that can be defined in Cypress config file &amp; then called inside tests or tests hooks. They are very useful if you need to run code that cannot be executed in a browser.
They are useful to fake an third party API or a browser API.</p>
<div class="language-js highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1">// In your app code</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="nb">window</span><span class="p">.</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">getCurrentPosition</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{});</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c1">// In your Cypress test</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="nx">cy</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nb">window</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">  </span><span class="nx">cy</span><span class="p">.</span><span class="nx">stub</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;getCurrentPosition&#39;</span><span class="p">).</span><span class="kr">as</span><span class="p">(</span><span class="s1">&#39;getUserPosition&#39;</span><span class="p">)</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="p">})</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;@getUserPosition&#39;</span><span class="p">).</span><span class="nx">should</span><span class="p">(</span><span class="s1">&#39;have.been.called&#39;</span><span class="p">);</span>
</span></code></pre></div>
<h3 id="stubs">Stubs</h3>
<p>A stub is a replacement for an existing function/method. They're used for evaluating &amp; controlling function calls.</p>
<h3 id="spies">Spies</h3>
<p>A spy is a Cypress tool that spies (with its little eye) a call of a specific function. It is useful when you want to make sure this function was indeed called, but when you don't need to fake its functioning (therefore when you don't need a stub)</p>
<h3 id="manipulating-the-clock">Manipulating the clock</h3>
<p>Manipulating the clock allows us to fake the passing of time, because sometimes things happen after a delay and we don't want our test to actually wait.</p>
<p>Example:
<div class="language-js highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nx">cy</span><span class="p">.</span><span class="nx">clock</span><span class="p">();</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="nx">cy</span><span class="p">.</span><span class="nx">tick</span><span class="p">(</span><span class="mf">2000</span><span class="p">);</span><span class="w"> </span><span class="c1">// Fake a 2 seconds delay</span>
</span></code></pre></div></p>
<h3 id="interceptors">Interceptors</h3>
<p>Interceptors are a tool that cypress provides to intercept certain requests made during the tests. They're useful for:
- Making sure the call was made.
- Blocking the request by mocking its return value.
- You need to test a behaviour (for example the display of a success or error message), but don't need to test what's under the hood.</p>
<blockquote>
<p>üöß Intercepting will not necessarily block the request, to actually block it, you need to mock the result.</p>
</blockquote>
<p>Example : 
<div class="language-js highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1">// Either you don&#39;t need to block the call, just intercept it.</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nx">cy</span><span class="p">.</span><span class="nx">intercept</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;https://newsletter.fnatic.com?*&#39;</span><span class="p">).</span><span class="kr">as</span><span class="p">(</span><span class="s1">&#39;subscribeNewsletter&#39;</span><span class="p">);</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="nx">cy</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;@subscribeNewsletter&#39;</span><span class="p">).</span><span class="nx">should</span><span class="p">(</span><span class="s1">&#39;have.been.called&#39;</span><span class="p">);</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c1">// Or you want to block the call: mock the response</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="nx">cy</span><span class="p">.</span><span class="nx">intercept</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;https://newsletter.fnatic.com?*&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="mf">201</span><span class="p">}).</span><span class="kr">as</span><span class="p">(</span><span class="s1">&#39;subscribeNewsletter&#39;</span><span class="p">);</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="c1">// In any case, if you need to wait for the response:</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="nx">cy</span><span class="p">.</span><span class="nx">wait</span><span class="p">(</span><span class="s1">&#39;@subscribeNewsletter&#39;</span><span class="p">);</span>
</span></code></pre></div></p>
<h2 id="good-practices">Good practices</h2>
<ul>
<li>Test cases names should be readable as a sentence: "it should display pending tasks" for example.</li>
<li>Test cases should be isolated, they should not depend on the previous test &amp; should always have the same starting point (reset database for example).</li>
<li>Fixtures should make sense and be reusable throughout tests.</li>
<li>The clock should be used to avoid actually waiting for our delays to expire, we should not actually wait.</li>
</ul>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["header.autohide", "search.suggest", "search.highlight", "search.share", "navigation.tracking", "navigation.tabs", "navigation.path", "navigation.top", "navigation.sections", "navigation.expand"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>